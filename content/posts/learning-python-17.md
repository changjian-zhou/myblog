---
title: "Learning Python 17"
date: 2024-09-19T10:01:49+08:00
draft: false
tags:
  - Python
---

# 作用域

在代码中的何处给一个名字赋值，对于确定这个名字的含义很关键。

## 变量名解析：LEGB原则

- 变量名引用分为三个作用域进行查找：首先是本地，之后是函数内，之后全局，最后是内置。
- 在默认情况下，变量名赋值会创建或者改变本地变量。
- 全局声明和非本地声明将赋值的变量名映射到模块文件内部的作用域。

## global语句

- 全局变量是位于模块文件内部的顶层的变量名
- 全局变量如果是在函数内被赋值的话，必须经过声明
- 全局变量名在函数的内部不经过声明也可以被引用

```python
X = 88
def func():
    global X
    X = 99
func()
print(X)
```
## 最小化全局变量
将函数中的值改为全局变量会引发一些软件工程问题：由于变量的值取决于函数调用的顺序，而函数
自身是任意顺序进行排列的，导致了程序调式起来变得很困难。

## 嵌套作用域
```python
X = 99
def f1():
    X = 88
    def f2():
        print(X)
    f2()
f1()  # 88
```

## 工厂函数
一个能够记住嵌套作用域的变量值的函数

## nonlocal
`nonlocal`关键字用于在`嵌套函数`中声明一个变量，该变量并非局部变量，也非全局变量，而是来自外层（非全局）函数作用域的变量。

